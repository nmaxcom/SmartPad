"use strict";(self.webpackChunksmartpad_docs=self.webpackChunksmartpad_docs||[]).push([[701],{4368(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"specs/file-management","title":"File Management","description":"Defines sheet storage, autosave, import/export behavior, trash lifecycle, and multi-tab synchronization.","source":"@site/docs/specs/file-management.md","sourceDirName":"specs","slug":"/specs/file-management","permalink":"/docs/specs/file-management","draft":false,"unlisted":false,"editUrl":"https://github.com/nmaxcom/SmartPad/tree/main/website/docs/specs/file-management.md","tags":[],"version":"current","frontMatter":{"title":"File Management","description":"Defines sheet storage, autosave, import/export behavior, trash lifecycle, and multi-tab synchronization."},"sidebar":"docsSidebar","previous":{"title":"Locale Date and Time","permalink":"/docs/specs/locale-date-time"}}');var t=i(4848),r=i(8453);const l={title:"File Management",description:"Defines sheet storage, autosave, import/export behavior, trash lifecycle, and multi-tab synchronization."},c=void 0,d={},a=[{value:"At a glance",id:"at-a-glance",level:2},{value:"Quick examples",id:"quick-examples",level:2},{value:"What this covers",id:"what-this-covers",level:2},{value:"Full specification",id:"full-specification",level:2},{value:"1. Objective",id:"1-objective",level:2},{value:"2. Technical Architecture",id:"2-technical-architecture",level:2},{value:"A. Storage Engine (IndexedDB)",id:"a-storage-engine-indexeddb",level:3},{value:"B. The Sync Mechanism (Multi-Tab Support)",id:"b-the-sync-mechanism-multi-tab-support",level:3},{value:"3. User Experience &amp; UI Flow",id:"3-user-experience--ui-flow",level:2},{value:"The Sidebar (Main View)",id:"the-sidebar-main-view",level:3},{value:"The Trash View",id:"the-trash-view",level:3},{value:"Import &amp; Export",id:"import--export",level:3},{value:"4. Functional Requirements",id:"4-functional-requirements",level:2},{value:"A. Auto-Save Logic (Debounced)",id:"a-auto-save-logic-debounced",level:3},{value:"B. New Sheet Creation",id:"b-new-sheet-creation",level:3},{value:"C. Markdown Integrity",id:"c-markdown-integrity",level:3}];function o(e){const n={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["Source: ",(0,t.jsx)(n.code,{children:"docs/Specs/FileManagement.spec.md"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"at-a-glance",children:"At a glance"}),"\n",(0,t.jsx)(n.p,{children:"Defines sheet storage, autosave, import/export behavior, trash lifecycle, and multi-tab synchronization."}),"\n",(0,t.jsx)(n.h2,{id:"quick-examples",children:"Quick examples"}),"\n",(0,t.jsx)(n.p,{children:"Examples for this feature are being backfilled."}),"\n",(0,t.jsx)(n.h2,{id:"what-this-covers",children:"What this covers"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Objective"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsx)(n.li,{children:"Technical Architecture"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsx)(n.li,{children:"User Experience & UI Flow"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsx)(n.li,{children:"Functional Requirements"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"full-specification",children:"Full specification"}),"\n",(0,t.jsxs)(i,{children:[(0,t.jsx)("summary",{children:"Open full spec: File Management"}),(0,t.jsxs)(n.p,{children:["This technical specification defines the ",(0,t.jsx)(n.strong,{children:"Smartpad File Management & Persistence System"}),'. The goal is to provide a seamless, "local-first" experience where users feel their work is as permanent as a physical notebook without ever needing to click a "Save" button.']}),(0,t.jsx)(n.hr,{}),(0,t.jsx)(n.h2,{id:"1-objective",children:"1. Objective"}),(0,t.jsxs)(n.p,{children:["Build a robust, markdown-based file management system using ",(0,t.jsx)(n.strong,{children:"IndexedDB"}),' for persistence. It must support multiple sheets, sidebar navigation, and effortless import/export functionality while maintaining a "scratchpad" aesthetic.']}),(0,t.jsx)(n.hr,{}),(0,t.jsx)(n.h2,{id:"2-technical-architecture",children:"2. Technical Architecture"}),(0,t.jsx)(n.h3,{id:"a-storage-engine-indexeddb",children:"A. Storage Engine (IndexedDB)"}),(0,t.jsxs)(n.p,{children:["The primary source of truth is the browser's ",(0,t.jsx)(n.strong,{children:"IndexedDB"}),"."]}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"Possible schema:"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"id"}),": Unique UUID."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"title"}),": String (parsed from the first ",(0,t.jsx)(n.code,{children:"#"})," heading in the markdown)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"content"}),": Full plaintext string."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"last_modified"}),": Timestamp."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"is_trashed"}),": Boolean (Default: ",(0,t.jsx)(n.code,{children:"false"}),")."]}),"\n"]}),(0,t.jsx)(n.h3,{id:"b-the-sync-mechanism-multi-tab-support",children:"B. The Sync Mechanism (Multi-Tab Support)"}),(0,t.jsxs)(n.p,{children:['To prevent "Ghost Tabs" from overwriting data, use the ',(0,t.jsx)(n.strong,{children:"BroadcastChannel API"}),"."]}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Action:"})," When any tab commits a save to IndexedDB, it broadcasts a message containing the ",(0,t.jsx)(n.code,{children:"id"})," of the updated sheet."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Reaction:"})," Other open tabs listen for this message. If they are currently viewing the same ",(0,t.jsx)(n.code,{children:"id"}),", they silently update their internal state/editor content to match."]}),"\n"]}),(0,t.jsx)(n.hr,{}),(0,t.jsx)(n.h2,{id:"3-user-experience--ui-flow",children:"3. User Experience & UI Flow"}),(0,t.jsx)(n.h3,{id:"the-sidebar-main-view",children:"The Sidebar (Main View)"}),(0,t.jsxs)(n.p,{children:["The sidebar is a flat list of all sheets where ",(0,t.jsx)(n.code,{children:"is_trashed == false"}),"."]}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Sheet Titles:"})," Dynamically updated. If a sheet has no ",(0,t.jsx)(n.code,{children:"# Header"}),", the UI shows the first 20 characters of the first line."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Inline Renaming:"})," Clicking the title in the sidebar transforms it into a text input. ",(0,t.jsx)(n.code,{children:"Enter"})," to save; ",(0,t.jsx)(n.code,{children:"Esc"})," to cancel."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Hover Actions:"})," When a user hovers over a sheet title, two icons appear:"]}),"\n"]}),(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Trash icon:"})," Sets ",(0,t.jsx)(n.code,{children:"is_trashed = true"}),". The sheet immediately disappears from the main list."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Download icon:"})," Triggers an immediate browser download of that single ",(0,t.jsx)(n.code,{children:".md"})," file."]}),"\n"]}),(0,t.jsx)(n.p,{children:"Use font awesome icons."}),(0,t.jsx)(n.h3,{id:"the-trash-view",children:"The Trash View"}),(0,t.jsx)(n.p,{children:"A dedicated state to manage discarded sheets without cluttering the main list."}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Access:"}),' A "Trash" link at the bottom of the sidebar.']}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Interaction:"}),' Clicking "Trash" replaces the main list with a list of sheets where ',(0,t.jsx)(n.code,{children:"is_trashed == true"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Actions in Trash:"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Restore:"})," Resets ",(0,t.jsx)(n.code,{children:"is_trashed = false"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Empty Trash:"})," Permanently deletes those records from IndexedDB."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Exit:"}),' A "Back" link returns to the main sheet list.']}),"\n"]}),"\n"]}),(0,t.jsx)(n.h3,{id:"import--export",children:"Import & Export"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Individual Export:"})," Handled via the hover icon (Download ",(0,t.jsx)(n.code,{children:".md"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Session Export:"}),' A "Download All" button at the bottom of the sidebar. This bundles all active (non-trashed) sheets into a single ',(0,t.jsx)(n.code,{children:".zip"})," file."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Import (Drag & Drop):"})," The entire webapp is a drop-zone."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsxs)(n.strong,{children:[(0,t.jsx)(n.code,{children:".md"})," files:"]})," Added as a new sheet."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsxs)(n.strong,{children:[(0,t.jsx)(n.code,{children:".zip"})," files:"]})," Unzipped, and all internal ",(0,t.jsx)(n.code,{children:".md"})," files are added as individual sheets."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Conflict Logic:"})," If an imported filename matches an existing title, append a number: e.g., ",(0,t.jsx)(n.code,{children:"Budget (1)"}),"."]}),"\n"]}),(0,t.jsx)(n.hr,{}),(0,t.jsx)(n.h2,{id:"4-functional-requirements",children:"4. Functional Requirements"}),(0,t.jsx)(n.h3,{id:"a-auto-save-logic-debounced",children:"A. Auto-Save Logic (Debounced)"}),(0,t.jsx)(n.p,{children:"The app must not save on every keystroke to optimize performance."}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Threshold:"})," ",(0,t.jsx)(n.strong,{children:"1500ms"})," (1.5 seconds) of idle time."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Trigger:"})," After the user stops typing for 1.5s, the current editor content is committed to IndexedDB and the ",(0,t.jsx)(n.code,{children:"last_modified"})," timestamp is updated."]}),"\n"]}),(0,t.jsx)(n.h3,{id:"b-new-sheet-creation",children:"B. New Sheet Creation"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Clicking the ",(0,t.jsx)(n.code,{children:"+"})," button at the top of the sidebar creates a blank record in IndexedDB and immediately switches the editor focus to that new sheet."]}),"\n"]}),(0,t.jsx)(n.h3,{id:"c-markdown-integrity",children:"C. Markdown Integrity"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Files are stored and exported as pure Markdown."}),"\n",(0,t.jsx)(n.li,{children:"No proprietary metadata should be injected into the text. The title should be inferred from the content, not stored separately in the file text."}),"\n"]})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8453(e,n,i){i.d(n,{R:()=>l,x:()=>c});var s=i(6540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);