"use strict";(self.webpackChunksmartpad_docs=self.webpackChunksmartpad_docs||[]).push([[422],{1930(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"specs/filemanagement","title":"FileManagement","description":"Build a robust, markdown-based file management system using **IndexedDB** for persistence. It must support multiple sheets, sidebar navigation, and effortless import/export functionality while maintaining a \\"scratchpad\\" aesthetic.","source":"@site/docs/specs/filemanagement.md","sourceDirName":"specs","slug":"/specs/filemanagement","permalink":"/docs/specs/filemanagement","draft":false,"unlisted":false,"editUrl":"https://github.com/nmaxcom/SmartPad/tree/main/website/docs/specs/filemanagement.md","tags":[],"version":"current","frontMatter":{"title":"FileManagement","description":"Build a robust, markdown-based file management system using **IndexedDB** for persistence. It must support multiple sheets, sidebar navigation, and effortless import/export functionality while maintaining a \\"scratchpad\\" aesthetic."},"sidebar":"docsSidebar","previous":{"title":"duration","permalink":"/docs/specs/duration"},"next":{"title":"Lists in Smartpad \u2014 single comprehensive document (markdown)","permalink":"/docs/specs/lists"}}');var t=s(4848),r=s(8453);const l={title:"FileManagement",description:'Build a robust, markdown-based file management system using **IndexedDB** for persistence. It must support multiple sheets, sidebar navigation, and effortless import/export functionality while maintaining a "scratchpad" aesthetic.'},d=void 0,a={},o=[{value:"1. Objective",id:"1-objective",level:2},{value:"2. Technical Architecture",id:"2-technical-architecture",level:2},{value:"A. Storage Engine (IndexedDB)",id:"a-storage-engine-indexeddb",level:3},{value:"B. The Sync Mechanism (Multi-Tab Support)",id:"b-the-sync-mechanism-multi-tab-support",level:3},{value:"3. User Experience &amp; UI Flow",id:"3-user-experience--ui-flow",level:2},{value:"The Sidebar (Main View)",id:"the-sidebar-main-view",level:3},{value:"The Trash View",id:"the-trash-view",level:3},{value:"Import &amp; Export",id:"import--export",level:3},{value:"4. Functional Requirements",id:"4-functional-requirements",level:2},{value:"A. Auto-Save Logic (Debounced)",id:"a-auto-save-logic-debounced",level:3},{value:"B. New Sheet Creation",id:"b-new-sheet-creation",level:3},{value:"C. Markdown Integrity",id:"c-markdown-integrity",level:3}];function c(e){const n={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["Source: ",(0,t.jsx)(n.code,{children:"docs/Specs/FileManagement.spec.md"})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["This technical specification defines the ",(0,t.jsx)(n.strong,{children:"Smartpad File Management & Persistence System"}),'. The goal is to provide a seamless, "local-first" experience where users feel their work is as permanent as a physical notebook without ever needing to click a "Save" button.']}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"1-objective",children:"1. Objective"}),"\n",(0,t.jsxs)(n.p,{children:["Build a robust, markdown-based file management system using ",(0,t.jsx)(n.strong,{children:"IndexedDB"}),' for persistence. It must support multiple sheets, sidebar navigation, and effortless import/export functionality while maintaining a "scratchpad" aesthetic.']}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"2-technical-architecture",children:"2. Technical Architecture"}),"\n",(0,t.jsx)(n.h3,{id:"a-storage-engine-indexeddb",children:"A. Storage Engine (IndexedDB)"}),"\n",(0,t.jsxs)(n.p,{children:["The primary source of truth is the browser's ",(0,t.jsx)(n.strong,{children:"IndexedDB"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"Possible schema:"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"id"}),": Unique UUID."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"title"}),": String (parsed from the first ",(0,t.jsx)(n.code,{children:"#"})," heading in the markdown)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"content"}),": Full plaintext string."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"last_modified"}),": Timestamp."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"is_trashed"}),": Boolean (Default: ",(0,t.jsx)(n.code,{children:"false"}),")."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"b-the-sync-mechanism-multi-tab-support",children:"B. The Sync Mechanism (Multi-Tab Support)"}),"\n",(0,t.jsxs)(n.p,{children:['To prevent "Ghost Tabs" from overwriting data, use the ',(0,t.jsx)(n.strong,{children:"BroadcastChannel API"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Action:"})," When any tab commits a save to IndexedDB, it broadcasts a message containing the ",(0,t.jsx)(n.code,{children:"id"})," of the updated sheet."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Reaction:"})," Other open tabs listen for this message. If they are currently viewing the same ",(0,t.jsx)(n.code,{children:"id"}),", they silently update their internal state/editor content to match."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"3-user-experience--ui-flow",children:"3. User Experience & UI Flow"}),"\n",(0,t.jsx)(n.h3,{id:"the-sidebar-main-view",children:"The Sidebar (Main View)"}),"\n",(0,t.jsxs)(n.p,{children:["The sidebar is a flat list of all sheets where ",(0,t.jsx)(n.code,{children:"is_trashed == false"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Sheet Titles:"})," Dynamically updated. If a sheet has no ",(0,t.jsx)(n.code,{children:"# Header"}),", the UI shows the first 20 characters of the first line."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Inline Renaming:"})," Clicking the title in the sidebar transforms it into a text input. ",(0,t.jsx)(n.code,{children:"Enter"})," to save; ",(0,t.jsx)(n.code,{children:"Esc"})," to cancel."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Hover Actions:"})," When a user hovers over a sheet title, two icons appear:"]}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Trash icon:"})," Sets ",(0,t.jsx)(n.code,{children:"is_trashed = true"}),". The sheet immediately disappears from the main list."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Download icon:"})," Triggers an immediate browser download of that single ",(0,t.jsx)(n.code,{children:".md"})," file."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Use font awesome icons."}),"\n",(0,t.jsx)(n.h3,{id:"the-trash-view",children:"The Trash View"}),"\n",(0,t.jsx)(n.p,{children:"A dedicated state to manage discarded sheets without cluttering the main list."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Access:"}),' A "Trash" link at the bottom of the sidebar.']}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Interaction:"}),' Clicking "Trash" replaces the main list with a list of sheets where ',(0,t.jsx)(n.code,{children:"is_trashed == true"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Actions in Trash:"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Restore:"})," Resets ",(0,t.jsx)(n.code,{children:"is_trashed = false"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Empty Trash:"})," Permanently deletes those records from IndexedDB."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Exit:"}),' A "Back" link returns to the main sheet list.']}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"import--export",children:"Import & Export"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Individual Export:"})," Handled via the hover icon (Download ",(0,t.jsx)(n.code,{children:".md"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Session Export:"}),' A "Download All" button at the bottom of the sidebar. This bundles all active (non-trashed) sheets into a single ',(0,t.jsx)(n.code,{children:".zip"})," file."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Import (Drag & Drop):"})," The entire webapp is a drop-zone."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsxs)(n.strong,{children:[(0,t.jsx)(n.code,{children:".md"})," files:"]})," Added as a new sheet."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsxs)(n.strong,{children:[(0,t.jsx)(n.code,{children:".zip"})," files:"]})," Unzipped, and all internal ",(0,t.jsx)(n.code,{children:".md"})," files are added as individual sheets."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Conflict Logic:"})," If an imported filename matches an existing title, append a number: e.g., ",(0,t.jsx)(n.code,{children:"Budget (1)"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"4-functional-requirements",children:"4. Functional Requirements"}),"\n",(0,t.jsx)(n.h3,{id:"a-auto-save-logic-debounced",children:"A. Auto-Save Logic (Debounced)"}),"\n",(0,t.jsx)(n.p,{children:"The app must not save on every keystroke to optimize performance."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Threshold:"})," ",(0,t.jsx)(n.strong,{children:"1500ms"})," (1.5 seconds) of idle time."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Trigger:"})," After the user stops typing for 1.5s, the current editor content is committed to IndexedDB and the ",(0,t.jsx)(n.code,{children:"last_modified"})," timestamp is updated."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"b-new-sheet-creation",children:"B. New Sheet Creation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Clicking the ",(0,t.jsx)(n.code,{children:"+"})," button at the top of the sidebar creates a blank record in IndexedDB and immediately switches the editor focus to that new sheet."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"c-markdown-integrity",children:"C. Markdown Integrity"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Files are stored and exported as pure Markdown."}),"\n",(0,t.jsx)(n.li,{children:"No proprietary metadata should be injected into the text. The title should be inferred from the content, not stored separately in the file text."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453(e,n,s){s.d(n,{R:()=>l,x:()=>d});var i=s(6540);const t={},r=i.createContext(t);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);