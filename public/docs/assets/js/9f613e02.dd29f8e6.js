"use strict";(self.webpackChunksmartpad_docs=self.webpackChunksmartpad_docs||[]).push([[911],{9683(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"specs/duration","title":"duration","description":"A `Duration` is a signed sum of component parts (hours/minutes/seconds/etc).","source":"@site/docs/specs/duration.md","sourceDirName":"specs","slug":"/specs/duration","permalink":"/docs/specs/duration","draft":false,"unlisted":false,"editUrl":"https://github.com/nmaxcom/SmartPad/tree/main/website/docs/specs/duration.md","tags":[],"version":"current","frontMatter":{"title":"duration","description":"A `Duration` is a signed sum of component parts (hours/minutes/seconds/etc)."}}');var r=i(4848),l=i(8453);const t={title:"duration",description:"A `Duration` is a signed sum of component parts (hours/minutes/seconds/etc)."},d=void 0,c={},o=[{value:"1) New concept: <code>Duration</code> is a first-class value (not just \u201cunit math\u201d)",id:"1-new-concept-duration-is-a-first-class-value-not-just-unit-math",level:2},{value:"1.1 Duration literal forms (all equivalent)",id:"11-duration-literal-forms-all-equivalent",level:3},{value:"1.2 Duration parsing precedence",id:"12-duration-parsing-precedence",level:3},{value:"1.3 Normalization and display of Duration",id:"13-normalization-and-display-of-duration",level:3},{value:"2) Time-of-day values: support <code>Time</code> as distinct from <code>DateTime</code>",id:"2-time-of-day-values-support-time-as-distinct-from-datetime",level:2},{value:"2.1 <code>Time</code> literal format",id:"21-time-literal-format",level:3},{value:"2.2 <code>Time</code> arithmetic with <code>Duration</code>",id:"22-time-arithmetic-with-duration",level:3},{value:"2.3 \u201cTime context\u201d when the user mixes Time with Date/DateTime",id:"23-time-context-when-the-user-mixes-time-with-datedatetime",level:3},{value:"3) Conversions: <code>to</code> should work for Duration and Time",id:"3-conversions-to-should-work-for-duration-and-time",level:2},{value:"3.1 Duration conversions (this is your third failing example)",id:"31-duration-conversions-this-is-your-third-failing-example",level:3},{value:"3.2 Time conversions",id:"32-time-conversions",level:3},{value:"4) DateTime + Duration parsing: accept \u201cduration phrases\u201d without punctuation",id:"4-datetime--duration-parsing-accept-duration-phrases-without-punctuation",level:2},{value:"4.1 DateTime literals with locale date formats",id:"41-datetime-literals-with-locale-date-formats",level:3},{value:"4.2 DateTime \xb1 Duration =&gt; DateTime",id:"42-datetime--duration--datetime",level:3},{value:"4.3 DateTime - DateTime =&gt; Duration",id:"43-datetime---datetime--duration",level:3},{value:"5) Disambiguation + safety rules (stuff that will bite you later)",id:"5-disambiguation--safety-rules-stuff-that-will-bite-you-later",level:2},{value:"5.1 The <code>m</code> problem: minutes vs meters",id:"51-the-m-problem-minutes-vs-meters",level:3},{value:"5.2 Implicit \u201ctime context\u201d heuristics",id:"52-implicit-time-context-heuristics",level:3},{value:"5.3 Clear errors that suggest fixes",id:"53-clear-errors-that-suggest-fixes",level:3},{value:"6) Concrete expected outputs for your 3 failing lines",id:"6-concrete-expected-outputs-for-your-3-failing-lines",level:2},{value:"7) Extra examples you probably want tests for (high value)",id:"7-extra-examples-you-probably-want-tests-for-high-value",level:2},{value:"Duration parsing torture tests",id:"duration-parsing-torture-tests",level:3},{value:"Time rollover clarity",id:"time-rollover-clarity",level:3},{value:"Mixed date + time",id:"mixed-date--time",level:3},{value:"Differences",id:"differences",level:3}];function a(e){const n={blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Source: ",(0,r.jsx)(n.code,{children:"docs/Specs/duration.spec.md"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Below is a ",(0,r.jsx)(n.strong,{children:"spec add-on"})," that covers your 3 failing examples and a bunch of \u201cyou\u2019ll hit these soon\u201d cases around ",(0,r.jsx)(n.strong,{children:"durations"}),", ",(0,r.jsx)(n.strong,{children:"time-only expressions"}),", and ",(0,r.jsx)(n.strong,{children:"datetime + duration"})," parsing. It\u2019s written to be descriptive (not just grammar), with lots of examples + expected results."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"1-new-concept-duration-is-a-first-class-value-not-just-unit-math",children:["1) New concept: ",(0,r.jsx)(n.code,{children:"Duration"})," is a first-class value (not just \u201cunit math\u201d)"]}),"\n",(0,r.jsx)(n.h3,{id:"11-duration-literal-forms-all-equivalent",children:"1.1 Duration literal forms (all equivalent)"}),"\n",(0,r.jsxs)(n.p,{children:["A ",(0,r.jsx)(n.code,{children:"Duration"})," is a signed sum of component parts (hours/minutes/seconds/etc)."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Accepted units (canonical):"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"week"}),", ",(0,r.jsx)(n.code,{children:"day"}),", ",(0,r.jsx)(n.code,{children:"hour"}),", ",(0,r.jsx)(n.code,{children:"minute"}),", ",(0,r.jsx)(n.code,{children:"second"}),", ",(0,r.jsx)(n.code,{children:"ms"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Also accept common aliases:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["hours: ",(0,r.jsx)(n.code,{children:"hr"}),", ",(0,r.jsx)(n.code,{children:"hrs"})]}),"\n",(0,r.jsxs)(n.li,{children:["minutes: ",(0,r.jsx)(n.code,{children:"m"})," (in context of time, not length)"]}),"\n",(0,r.jsxs)(n.li,{children:["seconds: ",(0,r.jsx)(n.code,{children:"sec"}),", ",(0,r.jsx)(n.code,{children:"secs"})]}),"\n",(0,r.jsxs)(n.li,{children:["months: ",(0,r.jsx)(n.code,{children:"mo"}),", ",(0,r.jsx)(n.code,{children:"mos"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Spacing rules (important for your errors):"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Allow ",(0,r.jsx)(n.strong,{children:"no space"})," between number and unit: ",(0,r.jsx)(n.code,{children:"2hours"}),", ",(0,r.jsx)(n.code,{children:"1min"}),", ",(0,r.jsx)(n.code,{children:"3s"})]}),"\n",(0,r.jsxs)(n.li,{children:["Allow ",(0,r.jsx)(n.strong,{children:"space"}),": ",(0,r.jsx)(n.code,{children:"2 hours"}),", ",(0,r.jsx)(n.code,{children:"1 min"}),", ",(0,r.jsx)(n.code,{children:"3 s"})]}),"\n",(0,r.jsxs)(n.li,{children:["Allow ",(0,r.jsx)(n.strong,{children:"mixed"}),": ",(0,r.jsx)(n.code,{children:"2hours 1min"}),", ",(0,r.jsx)(n.code,{children:"2 hours 1min"}),", ",(0,r.jsx)(n.code,{children:"2hours 1 min"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Chaining:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"A duration may contain multiple components in sequence, separated by spaces and/or plus signs."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"+"})," is optional and purely cosmetic inside durations."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:\n2hours 1min => 2 h 1 min"}),"\n",(0,r.jsx)(n.p,{children:"-2hours 1min => -2 h 1 min (whole literal is negative)"}),"\n",(0,r.jsx)(n.p,{children:"-2hours + 1min => -1 h 59 min (explicit mixed-sign math)"}),"\n",(0,r.jsx)(n.h3,{id:"12-duration-parsing-precedence",children:"1.2 Duration parsing precedence"}),"\n",(0,r.jsxs)(n.p,{children:["When the parser sees something like ",(0,r.jsx)(n.code,{children:"3h"})," it must prefer ",(0,r.jsx)(n.code,{children:"Duration"})," over \u201c3 * h variable\u201d. Concretely:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If a token matches ",(0,r.jsx)(n.code,{children:"{number}{duration-unit}"})," or ",(0,r.jsx)(n.code,{children:"{number} {duration-unit}"}),", interpret as ",(0,r.jsx)(n.code,{children:"DurationComponent"})," (unless the unit is clearly a different physical unit like ",(0,r.jsx)(n.code,{children:"m"})," in a context where meters are expected)."]}),"\n",(0,r.jsxs)(n.li,{children:["durations should still be their own \u201ctime duration\u201d unit family, so they can convert to ",(0,r.jsx)(n.code,{children:"s/min/h/d"})," etc reliably."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"13-normalization-and-display-of-duration",children:"1.3 Normalization and display of Duration"}),"\n",(0,r.jsx)(n.p,{children:"Rule: a leading sign applies to the entire duration literal."}),"\n",(0,r.jsx)(n.p,{children:"-3h 15min means -(3h + 15min)."}),"\n",(0,r.jsx)(n.p,{children:"Normalization may change how it\u2019s displayed (e.g., seconds to minutes), but must never change the meaning."}),"\n",(0,r.jsx)(n.p,{children:"Correct examples:"}),"\n",(0,r.jsx)(n.p,{children:"125s => 2 min 5 s\n-90min => -1 h 30 min\n1h 90min => 2 h 30 min\n-3h 15min => -3 h 15 min"}),"\n",(0,r.jsx)(n.p,{children:"Mixed-sign math must be explicit:"}),"\n",(0,r.jsx)(n.p,{children:"-3h + 15min => -2 h 45 min\n-3h - 15min => -3 h 15 min"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"2-time-of-day-values-support-time-as-distinct-from-datetime",children:["2) Time-of-day values: support ",(0,r.jsx)(n.code,{children:"Time"})," as distinct from ",(0,r.jsx)(n.code,{children:"DateTime"})]}),"\n",(0,r.jsxs)(n.p,{children:["Right now you clearly support ",(0,r.jsx)(n.code,{children:"Date"})," and ",(0,r.jsx)(n.code,{children:"DateTime"}),". The missing piece is making ",(0,r.jsx)(n.code,{children:"19:30"})," a real type."]}),"\n",(0,r.jsxs)(n.h3,{id:"21-time-literal-format",children:["2.1 ",(0,r.jsx)(n.code,{children:"Time"})," literal format"]}),"\n",(0,r.jsx)(n.p,{children:"Accept:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"HH:MM"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"HH:MM:SS"})}),"\n",(0,r.jsxs)(n.li,{children:["Optional seconds with ",(0,r.jsx)(n.code,{children:"s"})," suffix should remain duration, not time-of-day."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"19:30"})," => ",(0,r.jsx)(n.code,{children:"19:30"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"07:05:09"})," => ",(0,r.jsx)(n.code,{children:"07:05:09"})]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"22-time-arithmetic-with-duration",children:["2.2 ",(0,r.jsx)(n.code,{children:"Time"})," arithmetic with ",(0,r.jsx)(n.code,{children:"Duration"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Time \xb1 Duration => Time (with day rollover metadata)"})}),"\n",(0,r.jsxs)(n.p,{children:["This solves:\n",(0,r.jsx)(n.code,{children:"19:30 + 5h 20min 3s =>"})]}),"\n",(0,r.jsx)(n.p,{children:"Rules:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Result is a ",(0,r.jsx)(n.code,{children:"Time"}),", but computation must be done modulo 24h."]}),"\n",(0,r.jsxs)(n.li,{children:["If rollover occurs, attach a day delta internally (",(0,r.jsx)(n.code,{children:"+1 day"}),", ",(0,r.jsx)(n.code,{children:"-1 day"}),", etc)."]}),"\n",(0,r.jsxs)(n.li,{children:["Default display: show time only ",(0,r.jsx)(n.strong,{children:"plus"})," a rollover hint when non-zero."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"19:30 + 5h 20min 3s => 00:50:03 (+1 day)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"00:10 - 45min => 23:25 (-1 day)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"23:59:30 + 90s => 00:01:00 (+1 day)"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Time - Time => Duration"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"19:30 - 18:00 => 1 h 30 min"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"If negative, keep sign:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"18:00 - 19:30 => -1 h 30 min"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Time + Time is invalid"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"19:30 + 18:00 => error: cannot add two clock times; did you mean a duration?"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"23-time-context-when-the-user-mixes-time-with-datedatetime",children:"2.3 \u201cTime context\u201d when the user mixes Time with Date/DateTime"}),"\n",(0,r.jsx)(n.p,{children:"If an expression contains:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["a ",(0,r.jsx)(n.code,{children:"Date"})," and a ",(0,r.jsx)(n.code,{children:"Time"})," => combine to a ",(0,r.jsx)(n.code,{children:"DateTime"})," in the current timezone"]}),"\n",(0,r.jsxs)(n.li,{children:["a ",(0,r.jsx)(n.code,{children:"DateTime"})," and a ",(0,r.jsx)(n.code,{children:"Time"})," => ",(0,r.jsx)(n.strong,{children:"invalid"})," unless explicitly requested (too ambiguous)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"2025-04-01 + 19:30 => 2025-04-01 19:30 <local tz>"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"01/04/2025 19:30"})," (already supported) stays ",(0,r.jsx)(n.code,{children:"DateTime"})," (see \xa74.1)"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"3-conversions-to-should-work-for-duration-and-time",children:["3) Conversions: ",(0,r.jsx)(n.code,{children:"to"})," should work for Duration and Time"]}),"\n",(0,r.jsx)(n.h3,{id:"31-duration-conversions-this-is-your-third-failing-example",children:"3.1 Duration conversions (this is your third failing example)"}),"\n",(0,r.jsx)(n.p,{children:"Allow:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"duration to <time-unit>"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"duration in <time-unit>"})," (alias)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"as <time-unit>"})," optionally (if you want symmetry)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Conversion outputs a scalar with unit"}),", not a normalized multi-part duration."]}),"\n",(0,r.jsx)(n.p,{children:"Example (your failing case):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"3h 7min 12s to min => 187.2 min"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"More:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"125s to min => 2.083333 min"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"2 days 3h to h => 51 h"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"1h to s => 3600 s"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Fixed-length defaults for conversion math:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"1 month = 30 days"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"1 year = 365 days"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"21 months to weeks => 90 weeks"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"1 year in days => 365 days"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"32-time-conversions",children:"3.2 Time conversions"}),"\n",(0,r.jsx)(n.p,{children:"This is optional but useful:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"19:30 to s"})," is ambiguous (seconds since when?). So ",(0,r.jsx)(n.strong,{children:"forbid"})," converting ",(0,r.jsx)(n.code,{children:"Time"})," directly to duration units unless an anchor is provided."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Instead:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Allow formatting conversions:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"19:30 as HHMM => 1930"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"19:30 as 12h => 7:30 PM"})," (if you want locale formatting features)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["If you don\u2019t want formatting features yet: just keep ",(0,r.jsx)(n.code,{children:"Time"})," unconvertible except with an anchor date."]}),"\n",(0,r.jsx)(n.p,{children:"Anchor-based:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"2025-04-01 19:30 to UTC => 2025-04-01 18:30 UTC"})," (you already support zone conversion for DateTime)"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-datetime--duration-parsing-accept-duration-phrases-without-punctuation",children:"4) DateTime + Duration parsing: accept \u201cduration phrases\u201d without punctuation"}),"\n",(0,r.jsxs)(n.p,{children:["This fixes:\n",(0,r.jsx)(n.code,{children:"01/04/2025 19:30 - 2hours 1min =>"})]}),"\n",(0,r.jsx)(n.h3,{id:"41-datetime-literals-with-locale-date-formats",children:"4.1 DateTime literals with locale date formats"}),"\n",(0,r.jsx)(n.p,{children:"Given your earlier example:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"06/05/2024 => 2024-05-06"}),"\n\u2026your locale is effectively ",(0,r.jsx)(n.strong,{children:"DD/MM/YYYY"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"So:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"01/04/2025 19:30"})," must parse as ",(0,r.jsx)(n.code,{children:"2025-04-01 19:30"})," (local timezone unless specified)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"42-datetime--duration--datetime",children:"4.2 DateTime \xb1 Duration => DateTime"}),"\n",(0,r.jsx)(n.p,{children:"Rules:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["DateTime arithmetic must accept any ",(0,r.jsx)(n.code,{children:"Duration"})," form (spaced or unspaced)."]}),"\n",(0,r.jsx)(n.li,{children:"Duration components may be in any order."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Example (your failing case):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"01/04/2025 19:30 - 2hours 1min => 2025-04-01 17:29"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"More:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"2025-04-01 00:10 - 45min => 2025-03-31 23:25"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"2025-04-01 19:30 + 1h 90min => 2025-04-01 23:00"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"2025-04-01 19:30 + 24h => 2025-04-02 19:30"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"43-datetime---datetime--duration",children:"4.3 DateTime - DateTime => Duration"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"2025-04-01 19:30 - 2025-04-01 17:29 => 2 h 1 min"})}),"\n",(0,r.jsx)(n.li,{children:"Crossing DST: if you support timezone-aware DateTimes, the difference must reflect the actual elapsed seconds in that zone."}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"5-disambiguation--safety-rules-stuff-that-will-bite-you-later",children:"5) Disambiguation + safety rules (stuff that will bite you later)"}),"\n",(0,r.jsxs)(n.h3,{id:"51-the-m-problem-minutes-vs-meters",children:["5.1 The ",(0,r.jsx)(n.code,{children:"m"})," problem: minutes vs meters"]}),"\n",(0,r.jsxs)(n.p,{children:["Strong opinion: ",(0,r.jsx)(n.strong,{children:"do not"})," treat bare ",(0,r.jsx)(n.code,{children:"m"})," as minutes by default, because you already have physical units (",(0,r.jsx)(n.code,{children:"m"})," = meters). Safer rules:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"min"})," is minutes; ",(0,r.jsx)(n.code,{children:"m"})," is meters"]}),"\n",(0,r.jsxs)(n.li,{children:["If user writes ",(0,r.jsx)(n.code,{children:"5m"})," in a time-only context (like right after a ",(0,r.jsx)(n.code,{children:"Time"})," or inside a duration list), you may accept it as minutes, but warn/gray-hint."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"19:30 + 5m => 19:35"})," (allowed in \u201ctime context\u201d)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"height = 5m => 5 m"})," (meters)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"52-implicit-time-context-heuristics",children:"5.2 Implicit \u201ctime context\u201d heuristics"}),"\n",(0,r.jsxs)(n.p,{children:["If an expression begins with a ",(0,r.jsx)(n.code,{children:"Time"})," literal, prefer time math:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"19:30 + 5h =>"})," time-of-day result (with rollover hint)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"19:30 * 2 =>"})," ",(0,r.jsx)(n.strong,{children:"error"})," (multiplying a clock time is nonsense)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["If the expression contains a ",(0,r.jsx)(n.code,{children:"DateTime"}),", it\u2019s DateTime math."]}),"\n",(0,r.jsx)(n.h3,{id:"53-clear-errors-that-suggest-fixes",children:"5.3 Clear errors that suggest fixes"}),"\n",(0,r.jsx)(n.p,{children:"When rejecting something, suggest what the system thinks they meant."}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"19:30 + 18:00"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Error: \u201cCannot add two clock times. Did you mean ",(0,r.jsx)(n.code,{children:"19:30 - 18:00"})," or ",(0,r.jsx)(n.code,{children:"19:30 + 18h"}),"?\u201d"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"3h 7min 12s to kg"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Error: \u201cCannot convert a duration to mass.\u201d"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"6-concrete-expected-outputs-for-your-3-failing-lines",children:"6) Concrete expected outputs for your 3 failing lines"}),"\n",(0,r.jsxs)(n.p,{children:["Assuming locale ",(0,r.jsx)(n.strong,{children:"DD/MM/YYYY"})," and local timezone (Europe/Madrid unless overridden):"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"01/04/2025 19:30 - 2hours 1min=>"}),"\n",(0,r.jsx)(n.strong,{children:"Result:"})," ",(0,r.jsx)(n.code,{children:"2025-04-01 17:29"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"19:30 + 5h 20min 3s=>"}),"\n",(0,r.jsx)(n.strong,{children:"Result:"})," ",(0,r.jsx)(n.code,{children:"00:50:03 (+1 day)"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"3h 7min 12s to min =>"}),"\n",(0,r.jsx)(n.strong,{children:"Result:"})," ",(0,r.jsx)(n.code,{children:"187.2 min"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"7-extra-examples-you-probably-want-tests-for-high-value",children:"7) Extra examples you probably want tests for (high value)"}),"\n",(0,r.jsx)(n.h3,{id:"duration-parsing-torture-tests",children:"Duration parsing torture tests"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"2h1min"})," => ",(0,r.jsx)(n.code,{children:"2 h 1 min"})," (no spaces between components if you choose to support it; optional)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"1h -30min"})," => ",(0,r.jsx)(n.code,{children:"30 min"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-1h 30min"})," => ",(0,r.jsx)(n.code,{children:"-30 min"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"time-rollover-clarity",children:"Time rollover clarity"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"00:00 - 1s => 23:59:59 (-1 day)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"23:00 + 2h => 01:00 (+1 day)"})}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"mixed-date--time",children:"Mixed date + time"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"today + 19:30 => <today-date> 19:30"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"2025-04-01 + 25h => 2025-04-02 01:00"})," (if you allow Date + Duration to become DateTime; if not, forbid)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"differences",children:"Differences"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"2025-04-01 19:30 - 19:00 => 30 min"})," (DateTime - Time should be invalid unless you coerce Time to same date; if you ",(0,r.jsx)(n.em,{children:"do"})," coerce, define it explicitly)"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:["If you want a very clean implementation boundary: implement ",(0,r.jsx)(n.strong,{children:"Duration"})," + ",(0,r.jsx)(n.strong,{children:"Time"})," types, then add:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"robust duration tokenization (space/no-space)"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Time \xb1 Duration"}),", ",(0,r.jsx)(n.code,{children:"Time - Time"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Duration to <unit>"})," conversion"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["That alone will eliminate the three errors and make Smartpad feel ",(0,r.jsx)(n.em,{children:"way"})," more \u201chow I think\u201d for everyday planning."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453(e,n,i){i.d(n,{R:()=>t,x:()=>d});var s=i(6540);const r={},l=s.createContext(r);function t(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);